<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Genially Audio Player PRO</title>

<style>
body{
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:#0e0e0e;
  color:#fff;
  display:flex;
  height:100vh;
}

/* PANEL */
#panel{
  width:380px;
  padding:16px;
  background:#151515;
  box-sizing:border-box;
  overflow:auto;
}
#preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* UI */
h3{margin:4px 0 12px}
label{font-size:13px;opacity:.8;margin-top:10px;display:block}
input,textarea,button{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:10px;
  border:none;
}
textarea{background:#000;color:#00ff88;font-size:12px;height:110px}
button{background:#00ff88;color:#000;font-weight:600;cursor:pointer}
.mode{display:flex;gap:6px;margin-bottom:10px}
.mode button{flex:1}

/* PRESETS */
.presets{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.preset{
  padding:10px;border-radius:12px;background:#222;
  cursor:pointer;font-size:13px;text-align:center;opacity:.7
}
.preset.active{background:#00ff88;color:#000;opacity:1}
</style>
</head>

<body>

<div id="panel">
  <h3>ПРОФЕССИОНАЛЬНЫЙ Аудиоплеер</h3>

  <div class="mode">
    <button onclick="setMode('editor')">Редактор</button>
    <button onclick="setMode('player')">Игрок</button>
  </div>

  <label>Пресеты</label>
  <div class="presets" id="presets"></div>

  <label>Цвет акцента</label>
  <input type="color" id="accent">

  <label>Обложка</label>
  <input id="cover">

  <label>MP3 / raw GitHub (1 в строке)</label>
  <textarea id="tracks"></textarea>

  <label>
    <input type="checkbox" id="glowToggle">
    ✨ Неоновое свечение
  </label>

  <button onclick="update()">Получить код</button>
  <textarea id="code"></textarea>
</div>

<div id="preview"></div>

<script>
/* ===== PRESETS ===== */
const PRESETS={
  spotify:{name:"Spotify",accent:"#1db954",bg:"rgba(255,255,255,.08)",blur:14,radius:20,glow:false},
  neon:{name:"Neon",accent:"#00faff",bg:"rgba(0,0,0,.35)",blur:20,radius:24,glow:true}
};
let current={preset:"spotify"};

function buildPresets(){
  presets.innerHTML="";
  Object.entries(PRESETS).forEach(([k,p])=>{
    const d=document.createElement("div");
    d.className="preset"+(k===current.preset?" active":"");
    d.textContent=p.name;
    d.onclick=()=>applyPreset(k);
    presets.appendChild(d);
  });
}
function applyPreset(k){
  current.preset=k;
  Object.assign(current,PRESETS[k]);
  accent.value=current.accent;
  glowToggle.checked=!!current.glow;
  buildPresets();
  update();
}

/* ===== PLAYER ===== */
function renderPlayer(target,cfg){
  const glow = cfg.glow
    ? `box-shadow:0 0 14px ${cfg.accent},0 0 28px ${cfg.accent}66;`
    : `box-shadow:none;`;

  target.innerHTML=`
<div id="GENIALLY_AUDIO">
<style>
#GENIALLY_AUDIO{padding:18px;--accent:${cfg.accent}}
#GENIALLY_AUDIO button{all:unset}
.player{
  width:280px;
  background:${cfg.bg};
  backdrop-filter:blur(${cfg.blur}px);
  border-radius:${cfg.radius}px;
  padding:16px;
  text-align:center;
  color:white;
  ${glow}
}
img{width:100%;border-radius:14px}
.ctrl{display:flex;justify-content:center;gap:14px;margin:10px 0}
.ctrl button{
  width:46px;height:46px;border-radius:50%;
  background:var(--accent);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 8px var(--accent);
  cursor:pointer;
}
svg{width:22px;height:22px;fill:#000}
.icon{display:none}
#play.paused .play{display:block}
#play.playing .pause{display:block}
input[type=range]{width:100%}
.list{font-size:12px;text-align:left}
.list div{padding:6px;cursor:pointer;opacity:.7}
.list div.active{color:var(--accent);opacity:1}
</style>

<div class="player">
  <img src="${cfg.cover}">
  <div id="title"></div>

  <input type="range" id="seek">

  <div class="ctrl">
    <button id="prev">${svgPrev()}</button>

    <button id="play" class="paused">
      <svg class="icon play" viewBox="0 0 24 24">
        <polygon points="5,3 19,12 5,21"/>
      </svg>
      <svg class="icon pause" viewBox="0 0 24 24">
        <rect x="5" y="3" width="5" height="18"/>
        <rect x="14" y="3" width="5" height="18"/>
      </svg>
    </button>

    <button id="next">${svgNext()}</button>
  </div>

  <input type="range" id="volume" min="0" max="1" step="0.01">

  <div class="ctrl">
    <button id="shuffle">${svgShuffle()}</button>
    <button id="repeat">${svgRepeat()}</button>
  </div>

  <div class="list"></div>
  <audio></audio>
</div>
</div>`;

  const root=target.querySelector("#GENIALLY_AUDIO");
  const a=root.querySelector("audio");
  const playBtn=root.querySelector("#play");
  const t=root.querySelector("#title");
  const s=root.querySelector("#seek");
  const v=root.querySelector("#volume");
  const list=root.querySelector(".list");

  let i=0,shuffle=false,repeat=false;
  a.volume=1; v.value=1;

  const names=cfg.tracks.map(x=>x.split("/").pop().replace(".mp3",""));
  names.forEach((n,idx)=>{
    const d=document.createElement("div");
    d.textContent=n;
    d.onclick=()=>load(idx,true);
    list.appendChild(d);
  });

  function nextIndex(){
    return shuffle?Math.floor(Math.random()*cfg.tracks.length):(i+1)%cfg.tracks.length;
  }
  function load(x,auto){
    i=x;
    a.src=cfg.tracks[i];
    t.textContent=names[i];
    [...list.children].forEach((e,n)=>e.classList.toggle("active",n===i));
    if(auto)a.play();
  }
  load(0);

  playBtn.onclick=()=>a.paused?a.play():a.pause();

  a.onplay=()=>{
    playBtn.classList.remove("paused");
    playBtn.classList.add("playing");
  };
  a.onpause=()=>{
    playBtn.classList.remove("playing");
    playBtn.classList.add("paused");
  };

  a.ontimeupdate=()=>s.value=a.currentTime/a.duration*100||0;
  s.oninput=()=>a.currentTime=a.duration*s.value/100;
  v.oninput=()=>a.volume=v.value;

  root.querySelector("#next").onclick=()=>load(nextIndex(),true);
  root.querySelector("#prev").onclick=()=>load((i-1+cfg.tracks.length)%cfg.tracks.length,true);
  root.querySelector("#shuffle").onclick=()=>shuffle=!shuffle;
  root.querySelector("#repeat").onclick=()=>repeat=!repeat;
  a.onended=()=>repeat?(a.currentTime=0,a.play()):load(nextIndex(),true);
}

/* SVG ICONS */
const svgPrev=()=>`<svg viewBox="0 0 24 24"><polygon points="19,3 9,12 19,21"/><rect x="5" y="3" width="3" height="18"/></svg>`;
const svgNext=()=>`<svg viewBox="0 0 24 24"><polygon points="5,3 15,12 5,21"/><rect x="16" y="3" width="3" height="18"/></svg>`;
const svgShuffle=()=>`<svg viewBox="0 0 24 24"><path d="M16 3h5v5"/><path d="M4 20l16-16"/></svg>`;
const svgRepeat=()=>`<svg viewBox="0 0 24 24"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/></svg>`;

function update(){
  Object.assign(current,{
    accent:accent.value,
    cover:cover.value,
    tracks:tracks.value.trim().split("\n").filter(Boolean),
    glow:glowToggle.checked
  });
  renderPlayer(preview,current);
  code.value=`<div id="GENIALLY_AUDIO"></div><script>(${renderPlayer.toString()})(document.getElementById("GENIALLY_AUDIO"),${JSON.stringify(current)});<\/script>`;
}
function setMode(m){panel.style.display=m==="player"?"none":"block"}

const presets=document.getElementById("presets");
const accent=document.getElementById("accent");
const cover=document.getElementById("cover");
const tracks=document.getElementById("tracks");
const glowToggle=document.getElementById("glowToggle");
const preview=document.getElementById("preview");
const code=document.getElementById("code");

cover.value="https://picsum.photos/300";
tracks.value=`https://raw.githubusercontent.com/USERNAME/REPO/main/audio/track1.mp3
https://raw.githubusercontent.com/USERNAME/REPO/main/audio/track2.mp3`;

applyPreset("spotify");
</script>

</body>
</html>
