<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Genially Audio Player PRO</title>

<style>
body{
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:#0e0e0e;
  color:#fff;
  display:flex;
  height:100vh;
}

/* ---------- PANEL ---------- */
#panel{
  width:380px;
  padding:16px;
  background:#151515;
  box-sizing:border-box;
  overflow:auto;
}

#preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* ---------- UI ---------- */
h3{margin:4px 0 12px}
label{
  font-size:13px;
  opacity:.75;
  margin-top:10px;
  display:block;
}
input,textarea,button{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:10px;
  border:none;
  box-sizing:border-box;
}
textarea{
  background:#000;
  color:#00ff88;
  font-size:12px;
  height:110px;
}
button{
  background:#00ff88;
  color:#000;
  font-weight:600;
  cursor:pointer;
  margin-top:10px;
}

.mode{
  display:flex;
  gap:6px;
  margin-bottom:10px;
}
.mode button{flex:1}

/* ---------- PRESETS ---------- */
.presets{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}
.preset{
  padding:10px;
  border-radius:12px;
  background:#222;
  cursor:pointer;
  font-size:13px;
  text-align:center;
  opacity:.7;
}
.preset.active{
  background:#00ff88;
  color:#000;
  opacity:1;
}
</style>
</head>

<body>

<div id="panel">
  <h3>–ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ê—É–¥–∏–æ–ø–ª–µ–µ—Ä</h3>

  <div class="mode">
    <button onclick="setMode('editor')">–†–µ–¥–∞–∫—Ç–æ—Ä</button>
    <button onclick="setMode('player')">–ò–≥—Ä–æ–∫</button>
  </div>

  <label>–ü—Ä–µ—Å–µ—Ç—ã</label>
  <div class="presets" id="presets"></div>

  <label>–¶–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞</label>
  <input type="color" id="accent">

  <label>–û–±–ª–æ–∂–∫–∞</label>
  <input id="cover">

  <label>MP3 / raw GitHub (1 –≤ —Å—Ç—Ä–æ–∫–µ)</label>
  <textarea id="tracks"></textarea>

  <label>
    <input type="checkbox" id="glowToggle">
    ‚ú® –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ
  </label>

  <button onclick="update()">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
  <textarea id="code" placeholder="–ö–æ–¥ –¥–ª—è Genially"></textarea>
</div>

<div id="preview"></div>

<script>
/* ---------- PRESETS ---------- */
const PRESETS={
  spotify:{name:"Spotify",accent:"#1db954",bg:"rgba(255,255,255,.08)",blur:14,radius:20,glow:false},
  neon:{name:"Neon",accent:"#00faff",bg:"rgba(0,0,0,.35)",blur:20,radius:24,glow:true},
  minimal:{name:"Minimal",accent:"#4a90e2",bg:"rgba(255,255,255,.12)",blur:6,radius:14,glow:false},
  soft:{name:"Soft Glass",accent:"#ff9ecb",bg:"rgba(255,255,255,.18)",blur:10,radius:22,glow:false}
};

let current={preset:"spotify"};

/* ---------- PRESET UI ---------- */
function buildPresets(){
  presets.innerHTML="";
  Object.entries(PRESETS).forEach(([k,p])=>{
    const d=document.createElement("div");
    d.className="preset"+(k===current.preset?" active":"");
    d.textContent=p.name;
    d.onclick=()=>applyPreset(k);
    presets.appendChild(d);
  });
}

function applyPreset(key){
  current.preset=key;
  Object.assign(current,PRESETS[key]);
  accent.value=current.accent;
  glowToggle.checked=!!current.glow;
  buildPresets();
  update();
}

/* ---------- PLAYER (GENIALLY SAFE) ---------- */
function renderPlayer(target,cfg){
  const glow = cfg.glow
    ? `box-shadow:0 0 12px ${cfg.accent},0 0 24px ${cfg.accent}66;`
    : `box-shadow:none;`;

  target.innerHTML=`
<div id="GENIALLY_AUDIO">
<style>
#GENIALLY_AUDIO{
  position:relative;
  z-index:9999;
  padding:18px;
  box-sizing:border-box;
  --accent:${cfg.accent};
  font-family:Arial,sans-serif;
}

/* RESET GENIALLY */
#GENIALLY_AUDIO button{all:unset}
#GENIALLY_AUDIO input{all:unset}

/* PLAYER */
#GENIALLY_AUDIO .player{
  width:280px;
  background:${cfg.bg};
  backdrop-filter:blur(${cfg.blur}px);
  border-radius:${cfg.radius}px;
  padding:16px;
  color:white;
  text-align:center;
  ${glow}
}
#GENIALLY_AUDIO img{
  width:100%;
  border-radius:14px;
}
#GENIALLY_AUDIO .ctrl,
#GENIALLY_AUDIO .ctrl2{
  display:flex;
  justify-content:center;
  gap:12px;
  margin:10px 0;
}
#GENIALLY_AUDIO button{
  width:42px;
  height:42px;
  border-radius:50%;
  background:var(--accent);
  color:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  box-shadow:0 0 8px var(--accent);
}
#GENIALLY_AUDIO input[type=range]{
  width:100%;
}
#GENIALLY_AUDIO .list{
  max-height:120px;
  overflow:auto;
  font-size:12px;
  text-align:left;
}
#GENIALLY_AUDIO .list div{
  padding:6px;
  cursor:pointer;
  opacity:.7;
}
#GENIALLY_AUDIO .list div.active{
  color:var(--accent);
  opacity:1;
}
</style>

<div class="player">
  <img src="${cfg.cover}">
  <div id="title"></div>

  <input type="range" id="seek">

  <div class="ctrl">
    <button id="prev">‚óÄ</button>
    <button id="play">‚ñ∂</button>
    <button id="next">‚ñ∂‚ñ∂</button>
  </div>

  <input type="range" id="volume" min="0" max="1" step="0.01" value="1">

  <div class="ctrl2">
    <button id="shuffle">üîÄ</button>
    <button id="repeat">üîÅ</button>
  </div>

  <div class="list"></div>
  <audio></audio>
</div>
</div>`;

  const root=target.querySelector("#GENIALLY_AUDIO");
  const a=root.querySelector("audio");
  const t=root.querySelector("#title");
  const s=root.querySelector("#seek");
  const v=root.querySelector("#volume");
  const list=root.querySelector(".list");
  let i=0, shuffle=false, repeat=false;

  const names=cfg.tracks.map(x=>decodeURIComponent(x.split("/").pop().replace(".mp3","")));

  names.forEach((n,idx)=>{
    const d=document.createElement("div");
    d.textContent=n;
    d.onclick=()=>load(idx,true);
    list.appendChild(d);
  });

  function nextIndex(){
    return shuffle
      ? Math.floor(Math.random()*cfg.tracks.length)
      : (i+1)%cfg.tracks.length;
  }

  function load(x,auto){
    i=x;
    a.src=cfg.tracks[i];
    t.textContent=names[i];
    [...list.children].forEach((e,n)=>e.classList.toggle("active",n===i));
    if(auto) a.play();
  }

  load(0);

  root.querySelector("#play").onclick=()=>a.paused?a.play():a.pause();
  a.onplay=()=>root.querySelector("#play").textContent="‚ùö‚ùö";
  a.onpause=()=>root.querySelector("#play").textContent="‚ñ∂";

  a.ontimeupdate=()=>s.value=a.currentTime/a.duration*100||0;
  s.oninput=()=>a.currentTime=a.duration*s.value/100;

  v.oninput=()=>a.volume=v.value;

  root.querySelector("#next").onclick=()=>load(nextIndex(),true);
  root.querySelector("#prev").onclick=()=>load((i-1+cfg.tracks.length)%cfg.tracks.length,true);

  root.querySelector("#shuffle").onclick=()=>{
    shuffle=!shuffle;
    root.querySelector("#shuffle").style.opacity=shuffle?"1":".4";
  };
  root.querySelector("#repeat").onclick=()=>{
    repeat=!repeat;
    root.querySelector("#repeat").style.opacity=repeat?"1":".4";
  };

  a.onended=()=>repeat?(a.currentTime=0,a.play()):load(nextIndex(),true);
}

/* ---------- UPDATE ---------- */
function update(){
  Object.assign(current,{
    accent:accent.value,
    cover:cover.value,
    tracks:tracks.value.trim().split("\n").filter(Boolean),
    glow:glowToggle.checked
  });

  renderPlayer(preview,current);

  code.value=
`<div id="GENIALLY_AUDIO"></div>
<script>
(${renderPlayer.toString()})(document.getElementById("GENIALLY_AUDIO"), ${JSON.stringify(current)});
<\/script>`;
}

function setMode(m){
  panel.style.display=m==="player"?"none":"block";
}

/* ---------- INIT ---------- */
const presets=document.getElementById("presets");
const accent=document.getElementById("accent");
const cover=document.getElementById("cover");
const tracks=document.getElementById("tracks");
const glowToggle=document.getElementById("glowToggle");
const preview=document.getElementById("preview");
const code=document.getElementById("code");

cover.value="https://picsum.photos/300";
tracks.value=`https://raw.githubusercontent.com/USERNAME/REPO/main/audio/track1.mp3
https://raw.githubusercontent.com/USERNAME/REPO/main/audio/track2.mp3`;

applyPreset("spotify");
</script>

</body>
</html>
